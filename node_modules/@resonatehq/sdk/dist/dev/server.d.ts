import type { Message, Request, Response } from "../src/network/network";
interface DurablePromise {
    id: string;
    state: "pending" | "resolved" | "rejected" | "rejected_canceled" | "rejected_timedout";
    timeout: number;
    param: any;
    value: any;
    tags: Record<string, string>;
    iKeyForCreate?: string;
    iKeyForComplete?: string;
    createdOn?: number;
    completedOn?: number;
    callbacks?: Map<string, Callback>;
}
interface Callback {
    id: string;
    type: "resume" | "notify";
    promiseId: string;
    rootPromiseId: string;
    recv: string;
    timeout: number;
    createdOn: number;
}
interface Task {
    id: string;
    counter: number;
    state: "init" | "enqueued" | "claimed" | "completed";
    type: "invoke" | "resume" | "notify";
    recv: string;
    rootPromiseId: string;
    leafPromiseId: string;
    timeout: number;
    processId?: string;
    ttl?: number;
    expiry: number;
    createdOn: number;
    completedOn?: number;
}
interface Schedule {
    id: string;
    description?: string;
    cron: string;
    tags: Record<string, string>;
    promiseId: string;
    promiseTimeout: number;
    promiseParam: any;
    promiseTags: Record<string, string>;
    lastRunTime?: number;
    nextRunTime?: number;
    iKey?: string;
    createdOn?: number;
}
export declare class Server {
    readonly promises: Map<string, DurablePromise>;
    readonly tasks: Map<string, Task>;
    readonly schedules: Map<string, Schedule>;
    private routers;
    private targets;
    constructor();
    next(time: number): number | undefined;
    step(time: number): {
        msg: Message;
        recv: string;
    }[];
    process(requ: Request, time: number): Response;
    private createPromise;
    private createPromiseAndTask;
    private _createPromise;
    private readPromise;
    private completePromise;
    private createSubscription;
    private createCallback;
    private claimTask;
    private completeTask;
    private dropTask;
    private searchPromises;
    private searchSchedules;
    private heartbeatTasks;
    private createSchedule;
    private readSchedule;
    private deleteSchedule;
    private getPromise;
    private transitionPromise;
    private _transitionPromise;
    private transitionTask;
    private transitionSchedule;
}
export {};
//# sourceMappingURL=server.d.ts.map